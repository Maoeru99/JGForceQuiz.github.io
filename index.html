<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JG Force Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow-x: hidden;
  overflow-y: hidden; /* blocca lo scroll extra */
  background: black;
  font-family: 'Orbitron', sans-serif;
  color: #f5f5f5;
}

body {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100%;
}

#stars { position: fixed; top:0; left:0; width:100%; height:100%; z-index: -1; }

.quiz-wrapper {
  width: 100%;
  max-width: 600px;
  padding: 20px 15px 10px 15px;
  box-sizing: border-box;
}

h1 { color: #ffe81f; letter-spacing:2px; margin-bottom:10px; text-align:center;}
h2 { margin-top:0; }

.domanda { display:none; background: rgba(0,0,0,0.6); padding: 15px; border-radius:12px; margin-bottom:15px; }
.domanda.attiva { display:block; animation: fadeInUp 0.5s ease forwards; }
.domanda.esci { animation: fadeOutDown 0.5s ease forwards; }

label { display:block; background: rgba(255,255,255,0.05); border-radius:8px; padding:12px; margin:12px 0; cursor:pointer; transition: all 0.3s; user-select:none; }
/* radio button nascosti */
input[type="radio"] { 
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

button {
  margin-top:15px; padding:16px 36px; font-size:18px; font-family:'Orbitron',sans-serif;
  border:none; border-radius:30px; color:white; cursor:pointer;
  background: linear-gradient(90deg,#3f8cff,#1b3cff); box-shadow:0 0 15px rgba(63,140,255,0.6);
  position: relative; overflow:hidden; transition: all 0.3s ease;
  flex-shrink: 0;
}
button::before {
  content:""; position:absolute; top:0; left:0; right:0; bottom:0; border-radius:30px;
  box-shadow:0 0 30px #3f8cff,0 0 60px #3f8cff inset; opacity:0.6; transition: all 0.3s ease; pointer-events:none;
}
button:active::before { box-shadow:0 0 60px #3f8cff,0 0 100px #3f8cff inset; opacity:1; }

#progress-container { width:100%; height:8px; background:#222; border-radius:4px; overflow:hidden; margin:20px 0 15px;}
#progress-bar { height:100%; width:0%; background: linear-gradient(90deg,#3f8cff,#ffe81f,#c62828); transition: width 0.4s ease; }

#output { margin-top:20px; padding:15px; border-radius:12px; background: rgba(0,0,0,0.6); white-space: pre-line; text-align:left; position:relative; }

#socials { margin-top:30px; display:none; justify-content:center; gap:30px; }

@keyframes fadeInUp { 0%{opacity:0;transform:translateY(30px);} 100%{opacity:1;transform:translateY(0);} }
@keyframes fadeOutDown { 0%{opacity:1;transform:translateY(0);} 100%{opacity:0;transform:translateY(30px);} }

@media(max-width:480px){
  body{padding:0;} h1{font-size:24px;} h2{font-size:18px;} label{font-size:16px;} 
  #progress-container{height:6px;margin:15px 0 20px;} 
}
</style>
</head>
<body>
<canvas id="stars"></canvas>

<div class="quiz-wrapper">
  <img src="logo.png" style="width:150px; height:auto; display:block; margin: 0 auto 20px;">

  <h1>Quiz della Forza</h1>
  <p style="font-size:12px; opacity:0.7;">Scopri se sei Jedi, Sith o Jedi Grigio</p>
  <div id="progress-container"><div id="progress-bar"></div></div>

  <!-- Domande -->
  <div class="domanda attiva">
    <h2>Domanda 1: Quale lato della Forza ti attrae di piÃ¹?</h2>
    <label><input type="radio" name="q0" value="jedi"> La luce e l'equilibrio</label>
    <label><input type="radio" name="q0" value="sith"> Il potere e la passione</label>
    <label><input type="radio" name="q0" value="grigio"> Entrambi, a seconda del momento</label>
  </div>

  <div class="domanda">
    <h2>Domanda 2: Cosa faresti se qualcuno ti provocasse?</h2>
    <label><input type="radio" name="q1" value="jedi"> Rimango calmo e ragiono</label>
    <label><input type="radio" name="q1" value="sith"> Colpirei subito con forza</label>
    <label><input type="radio" name="q1" value="grigio"> Dipende dalla situazione</label>
  </div>

  <button id="next">Avanti</button>
  <div id="output"></div>
  <canvas id="chart" width="300" height="300" style="margin-top:20px;"></canvas>
  <button id="ricomincia" style="display:none;">ðŸ”„ Ricomincia il Quiz</button>
  <div id="socials"></div>
</div>

<script>
// --- Variabili e setup ---
let domandaCorrente=0;
const domande=document.querySelectorAll(".domanda");
const nextBtn=document.getElementById("next");
const ricominciaBtn=document.getElementById("ricomincia");
const progressBar=document.getElementById("progress-bar");
const chartCanvas=document.getElementById("chart");
const ctxChart=chartCanvas.getContext("2d");
const socialsDiv=document.getElementById("socials");
let punteggi={jedi:0,sith:0,grigio:0};

function aggiornaProgress(){ progressBar.style.width=((domandaCorrente)/domande.length*100)+"%"; }

// --- Avanti ---
nextBtn.addEventListener("click",function(){
  const selected=document.querySelector('input[name="q'+domandaCorrente+'"]:checked');
  if(!selected){ alert("Seleziona una risposta!"); return; }
  punteggi[selected.value]++;

  const currentDomanda = domande[domandaCorrente];
  currentDomanda.classList.add("esci"); 
  setTimeout(()=>{
    currentDomanda.classList.remove("attiva","esci");
    domandaCorrente++;
    if(domandaCorrente<domande.length){
      domande[domandaCorrente].classList.add("attiva"); 
    } else { mostraRisultato(); }
    aggiornaProgress();
  },500);
});

// --- Mostra risultato ---
function mostraRisultato(){
  const output=document.getElementById("output");
  let esito="âš–ï¸ Jedi Grigio â€“ cammini tra luce e oscuritÃ ";
  let colore="#a080ff";
  if(punteggi.jedi>punteggi.sith && punteggi.jedi>punteggi.grigio){ esito="ðŸŸ¦ Jedi â€“ segui la luce e lâ€™equilibrio della Forza"; colore="#3f8cff"; }
  else if(punteggi.sith>punteggi.jedi && punteggi.sith>punteggi.grigio){ esito="ðŸŸ¥ Sith â€“ la passione e il potere guidano le tue scelte"; colore="#c62828"; }

  const totale=punteggi.jedi+punteggi.sith+punteggi.grigio;
  const percJedi = ((punteggi.jedi/totale)*100).toFixed(0);
  const percSith = ((punteggi.sith/totale)*100).toFixed(0);
  const percGrigio = ((punteggi.grigio/totale)*100).toFixed(0);

  output.innerText=`Punteggi finali:\nJedi: ${punteggi.jedi} (${percJedi}%)\nSith: ${punteggi.sith} (${percSith}%)\nJedi Grigio: ${punteggi.grigio} (${percGrigio}%)\n\n${esito}`;
  output.style.color=colore;
  output.style.textShadow=`0 0 25px ${colore},0 0 50px ${colore}`;
  nextBtn.style.display="none";
  ricominciaBtn.style.display="inline-block";
  ricominciaBtn.style.background=`linear-gradient(90deg,${colore},${colore})`;
  ricominciaBtn.style.boxShadow=`0 0 20px ${colore},0 0 50px ${colore} inset`;
  progressBar.style.width="100%";

  // grafico a torta
  ctxChart.clearRect(0,0,chartCanvas.width,chartCanvas.height);
  const data = [
    {label:"Jedi", value:punteggi.jedi, color:"#3f8cff"},
    {label:"Sith", value:punteggi.sith, color:"#c62828"},
    {label:"Grigio", value:punteggi.grigio, color:"#a080ff"}
  ];
  let startAngle = -0.5 * Math.PI;
  data.forEach(d=>{
    const sliceAngle = (d.value/totale) * 2 * Math.PI;
    ctxChart.beginPath();
    ctxChart.moveTo(150,150);
    ctxChart.arc(150,150,120,startAngle,startAngle+sliceAngle);
    ctxChart.closePath();
    ctxChart.fillStyle=d.color;
    ctxChart.fill();
    
    const midAngle = startAngle + sliceAngle/2;
    const labelX = 150 + Math.cos(midAngle)*80;
    const labelY = 150 + Math.sin(midAngle)*80;
    const perc = totale===0 ? 0 : Math.round((d.value/totale)*100);
    if (perc > 0) {
      ctxChart.fillStyle="#fff";
      ctxChart.font="16px 'Orbitron'";
      ctxChart.textAlign="center";
      ctxChart.textBaseline="middle";
      ctxChart.fillText(perc+"%", labelX, labelY);
    }

    startAngle += sliceAngle;
  });

  // socials
  socialsDiv.innerHTML = `
    <a href="https://www.instagram.com/jgacademy.national" target="_blank"><svg width="40" height="40" fill="#E1306C" xmlns="http://www.w3.org/2000/svg"><path d="M7.75 2h8.5C19.55 2 22 4.45 22 7.75v8.5C22 19.55 19.55 22 16.25 22h-8.5C4.45 22 2 19.55 2 16.25v-8.5C2 4.45 4.45 2 7.75 2zm0 1.5C5.68 3.5 4 5.18 4 7.25v8.5C4 18.32 5.68 20 7.75 20h8.5c2.07 0 3.75-1.68 3.75-3.75v-8.5C20 5.18 18.32 3.5 16.25 3.5h-8.5z"/><path d="M12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 1.5a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7zM17.5 6.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg></a>
    <a href="https://www.tiktok.com/@jgacademy.pavia" target="_blank"><svg width="40" height="40" fill="#69C9D0" xmlns="http://www.w3.org/2000/svg"><path d="M12 2v7.5a4.5 4.5 0 1 0 4.5 4.5V7.5h3V2h-7.5z"/></svg></a>
  `;
  socialsDiv.style.display="flex";
}

// ricomincia
ricominciaBtn.addEventListener("click",function(){
  punteggi={jedi:0,sith:0,grigio:0};
  domandaCorrente=0;
  domande.forEach(d=>d.classList.remove("attiva"));
  domande[0].classList.add("attiva");
  document.getElementById("output").innerText="";
  document.getElementById("output").style.color="#f5f5f5";
  document.getElementById("output").style.textShadow="none";
  ctxChart.clearRect(0,0,chartCanvas.width,chartCanvas.height);
  socialsDiv.innerHTML="";
  socialsDiv.style.display="none";
  nextBtn.style.display="inline-block";
  ricominciaBtn.style.display="none";
  aggiornaProgress();
});

// stelle animate
const canvas=document.getElementById('stars');
const ctx=canvas.getContext('2d');
let width=canvas.width=window.innerWidth;
let height=canvas.height=window.innerHeight;
const stars=[];
const numStars=150;
for(let i=0;i<numStars;i++){ stars.push({ x:Math.random()*width, y:Math.random()*height, r:Math.random()*1.5+0.5, dx:(Math.random()-0.5)/2, dy:(Math.random()-0.5)/2 }); }
function animateStars(){ ctx.clearRect(0,0,width,height); for(let s of stars){ ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle="white"; ctx.fill(); s.x+=s.dx; s.y+=s.dy; if(s.x<0)s.x=width; if(s.x>width)s.x=0; if(s.y<0)s.y=height; if(s.y>height)s.y=0; } requestAnimationFrame(animateStars); }
animateStars();
window.addEventListener('resize',()=>{ width=canvas.width=window.innerWidth; height=canvas.height=window.innerHeight; });

// floatUp
const style=document.createElement("style");
style.innerHTML=`@keyframes floatUp {0%{transform:translateY(0);opacity:1;}100%{transform:translateY(-100px);opacity:0;}}`;
document.head.appendChild(style);
</script>
</body>
</html>
